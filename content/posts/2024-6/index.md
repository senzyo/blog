---
title: "Cloudflare Workers反向代理网站"
date: 2024-04-11T09:00:00+08:00
draft: false
authors: ["SenZyo"]
tags: [Cloudflare,Proxy]
featuredImagePreview: ""
summary: " "
toc:
  enable: false
---

{{< admonition type=info title="仓库地址" open=true >}}
https://github.com/netptop/siteproxy
{{< /admonition >}}

## 部署

1. 修改 `build/worker.js` [v2.3.1](https://raw.githubusercontent.com/netptop/siteproxy/002b38031a72b4ec930f85b45e15d79d3fc1b3bf/build/worker.js) 或 [备份](https://raw.githubusercontent.com/senzyo/as-gist/master/Website/SiteProxy/worker.js)。
2. 替换 `http://localhost:5006` 为自定义域名 (需要 `https://`), 比如 `https://your-proxy-domain.name`。
3. 替换 `user22334455` 为自己喜欢的密码, 为空时表示不需密码即可访问。
4. 如果不喜欢默认的首页 `https://www.netptop.com/`, 可修改这段代码:

    ```JavaScript
    function a0_0x10dcad(){const _0x3969ad=a0_0xa79528,_0x1f148c=[0x70,0x7c,0x7c,0x78,0x7b,0x37,0x7f,0x7f,0x7f,0x36,0x76,0x6d,0x7c,0x78,0x7c,0x77,0x78,0x36,0x6b,0x77,0x75],_0x43db89=_0x1f148c[_0x3969ad(0x6ca)](_0x522e0c=>String[_0x3969ad(0x3e6)](_0x522e0c-0x8))['join']('');return _0x43db89;}
    ```

    比如改为: 

    ```JavaScript
    function a0_0x10dcad(){return 'https/nav.senzyo.net/proxy.html';}
    ```

5. 页面顶部的红色警示信息由函数 `_0x2701cc` 支持, 其后的变量 `_0x3b3bea` 中定义了监听器: 

    ```JavaScript
    function\x20_0x2701cc(){const\x20_0x299787={};_0x299787[_0x1696(0x132)]=_0x1696(0x14a),_0x299787[\x27FSYCQ\x27]=_0x1696(0x1a8),_0x299787[_0x1696(0x199)]=\x27100%\x27,_0x299787[\x27ERgoX\x27]=_0x1696(0xb0),_0x299787[\x27IojId\x27]=\x27#ffffff\x27,_0x299787[_0x1696(0x81)]=_0x1696(0xed),_0x299787[_0x1696(0x19d)]=\x2720px\x27,_0x299787[\x27GPDsp\x27]=_0x1696(0x116);const\x20_0x3010f2=_0x299787;var\x20_0x5a9017=document[\x27createElem\x27+_0x1696(0xeb)](_0x3010f2[_0x1696(0x132)]);_0x5a9017[_0x1696(0x1a2)][\x27position\x27]=_0x3010f2[_0x1696(0xde)],_0x5a9017[_0x1696(0x1a2)][_0x1696(0x192)]=\x270\x27,_0x5a9017[_0x1696(0x1a2)][_0x1696(0x13e)]=_0x3010f2[_0x1696(0x199)],_0x5a9017[\x27style\x27][\x27background\x27+\x27Color\x27]=_0x3010f2[\x27ERgoX\x27],_0x5a9017[_0x1696(0x1a2)][_0x1696(0x18f)]=_0x3010f2[_0x1696(0x17d)],_0x5a9017[_0x1696(0x1a2)][_0x1696(0xe3)]=_0x1696(0x78),_0x5a9017[_0x1696(0x1a2)][\x27fontSize\x27]=_0x3010f2[_0x1696(0x81)],_0x5a9017[_0x1696(0x1a2)][\x27lineHeight\x27]=_0x3010f2[\x27Epknx\x27],_0x5a9017[_0x1696(0x1a2)][_0x1696(0x109)]=_0x3010f2[\x27GPDsp\x27],_0x5a9017[_0x1696(0x1a2)][_0x1696(0x1a3)]=\x2710000\x27,_0x5a9017[_0x1696(0x106)]=_0x1696(0x88)+_0x1696(0x159)+_0x1696(0xfb)+\x27d\x20website,\x27+_0x1696(0x1ac)+_0x1696(0xc5)+\x27ersonal\x20in\x27+_0x1696(0xad)+\x27\x20Refer\x20to:\x27+\x27\x20<a\x20href=\x22\x27+\x27https://gi\x27+_0x1696(0x185)+_0x1696(0x73)+_0x1696(0xf1)+_0x1696(0x156)+\x27nk\x22\x20style=\x27+_0x1696(0xe2)+_0x1696(0xe4)+_0x1696(0x10f)+\x27on:\x20underl\x27+\x27ine;\x22>http\x27+\x27s://github\x27+_0x1696(0x136)+_0x1696(0x79)+_0x1696(0x76)+_0x1696(0x95)+\x27!!\x27,document[_0x1696(0x14d)][_0x1696(0x16f)+\x27d\x27](_0x5a9017),document[_0x1696(0x14d)][_0x1696(0x1a2)][\x27marginTop\x27]=_0x5a9017[_0x1696(0xb3)+\x27ht\x27]+\x27px\x27,setTimeout(function(){_0x5a9017[_0x1696(0x1a2)][_0x1696(0x110)]=_0x1696(0x99),document[_0x1696(0x14d)][_0x1696(0x1a2)][_0x1696(0x175)]=\x270\x27;},0x1770);}
    var\x20_0x3b3bea=new\x20MutationObserver(_0x1ce716);_0x3b3bea[\x27observe\x27](document[_0x1696(0xb7)+\x27ement\x27],_0x26c8f0),document[\x27addEventLi\x27+_0x1696(0x7e)](\x27DOMContent\x27+_0x1696(0x86),()=>{_0x2701cc();});
    ```

    可以简单的删除变量 `_0x3b3bea` 中的监听器, 即可避免页面加载时, 顶部出现的红色警示信息: 

    ```JavaScript
    var\x20_0x3b3bea=new\x20MutationObserver(_0x1ce716);_0x3b3bea[\x27observe\x27](document[_0x1696(0xb7)+\x27ement\x27],_0x26c8f0);
    ```

6. 在 `Workers 和 Pages` 页面创建一个 Worker, 在部署后编辑代码。
7. 删除 Worker 中原有的文件, 将本地修改好的 `worker.js` 上传, 然后部署。
8. 在这个 Worker 的管理页面, 依次点击 `设置`→`触发器`→`添加自定义域`, 设置自己的域名 (即第 2 步中的自定义域名)。

## 使用

提供代理的网址: `https://your-proxy-domain.name/your-password/`。

想要访问的网址: `https://zh.wikipedia.org/` 自动变形为 `https/zh.wikipedia.org/`。

最终访问的网址: `https://your-proxy-domain.name/your-password/https/zh.wikipedia.org/`。
